<link rel="import" href="../element.html">
<link rel="import" href="../magnon-icon-button/magnon-icon-button.html">
<link rel="import" href="../magnon-logo/magnon-logo.html">
<link rel="import" href="../magnon-drawer/magnon-drawer.html">
<link rel="import" href="../magnon-footer/magnon-footer.html">
<link rel="import" href="../magnon-styles/magnon-styles.html">

<template id="magnon-shell">
    <style>
        :host {
            position: fixed;
            top: 0; right: 0; bottom: 0; left: 0;
            width: 100vw;
            height: 100vh;

            font-family: var(--magnon-font);

            --magnon-header-height: 125px;

            overflow-y: scroll;
            overflow-x: auto;

            background: var(--magnon-shell-background, var(--magnon-grey));
        }

        #header-container {
            position: absolute;
            top: 0; right: 0; bottom: 0; left: 0;
            display: flex;
            width: 100%;
            height: var(--magnon-header-height);

            justify-content: center;
            flex-direction: column;

            padding: 5px;
            box-sizing: border-box;

            background: var(--magnon-shell-color, var(--magnon-normal-blue));
            color: white;

            box-shadow: var(--magnon-shadow-1);
        }

        #header-container > * {
            flex-grow: 1;
        }

        #navigation-button {
            position: absolute;
            top: 5px;
            left: 5px;

            --magnon-icon-button-padding: 5px;
            --magnon-icon-color: white;
            --magnon-icon-size: 30px;

            display: none;
        }

        #logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        nav {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        nav ::slotted(a) {
            color: white;
            text-decoration: none;
            font-size: 18px;

            margin: 0 10px;
        }

        #logo-link {
            height: 40px;
            pointer-events: all;
        }

        #logo-link > magnon-logo {
            height: 100%;
        }

        #main-container {
            position: absolute;
            top: var(--magnon-header-height);
            left: 0;
            right: 0;

            width: 100%;
            min-height: calc(100% - var(--magnon-header-height));
        }

        #content-container {
            margin: 20px auto 0 auto;
            width: 70vw;

            box-sizing: border-box;
            min-height: 100%;
            padding-bottom: 300px;
        }

        #content-container.expand-content {
            width: 100%;
            max-width: 100%;
            min-height: calc(100vh - var(--magnon-header-height) + 300px);
            margin: 0;
        }

        magnon-footer {
            position: absolute;
            bottom: 0;
            width: 100%;
        }
    </style>

    <div id="header-container">
        <magnon-icon-button id="navigation-button" icon="menu"></magnon-icon-button>
        <div id="logo-container">
            <a id="logo-link" href="/" title="Magnon Homepage">
                <magnon-logo animate></magnon-logo>
            </a>
        </div>
        <nav>
            <slot name="nav"></slot>
        </nav>
    </div>

    <magnon-drawer></magnon-drawer>

    <div id="main-container">
        <div id="content-container">
            <slot name="content"></slot>
        </div>

        <magnon-footer></magnon-footer>
    </div>
</template>

<script>
    /* globals MagnonElement */
    class MagnonShell extends MagnonElement {
        constructor() {
            super();

            this._drawer = this.root.querySelector("magnon-drawer");
            this._content = this.root.querySelector("#content-container");
            this._navButton = this.root.querySelector("magnon-icon-button");
        }

        connectedCallback() {
            this._navButton.addEventListener("click", () => {
                this._drawer.open = !this._drawer.open;
            });
        }

        static get name() {
            return "magnon-shell";
        }

        static get propertyAttributes() {
            return {
                bool: ["expand-content", "use-drawer"]
            };
        }

        propertySet(property, old, value) {
            if (property === "expand-content") {
                if (value) this._content.classList.add("expand-content");
                else this._content.classList.remove("expand-content");
            } else if (property === "use-drawer") {
                this._navButton.style.display = value ? "block" : "none";
            }
        }
    }

    MagnonShell.init();
</script>
